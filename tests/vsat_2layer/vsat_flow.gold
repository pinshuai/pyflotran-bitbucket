SIMULATION
  SIMULATION_TYPE SUBSURFACE
  PROCESS_MODELS
    SUBSURFACE_FLOW flow
      MODE richards
    / 
  / 
END

SUBSURFACE

REGRESSION
  CELLS_PER_PROCESS 5
END

GRID
  TYPE structured
  BOUNDS
    0.0 0.0 0.0 
    1.0 1.0 10.0 
  /
  NXYZ 1 1 100 
END

TIME
  FINAL_TIME 3.5 y
  INITIAL_TIMESTEP_SIZE 1.0 h
  MAXIMUM_TIMESTEP_SIZE 0.05 y
END

MATERIAL_PROPERTY soil1
  ID 1
  POROSITY 0.25
  SATURATION_FUNCTION sf1
  PERMEABILITY
    PERM_ISO 1.000d-12
  /
END

MATERIAL_PROPERTY soil2
  ID 2
  POROSITY 0.3
  SATURATION_FUNCTION sf2
  PERMEABILITY
    PERM_ISO 2.000d-12
  /
END

LINEAR_SOLVER flow
  SOLVER DIRECT
END

OUTPUT
  PERIODIC TIME 0.1 y
  PERIODIC_OBSERVATION TIMESTEP 1
  FORMAT TECPLOT POINT
END

SATURATION_FUNCTION  sf1
  SATURATION_FUNCTION_TYPE VAN_GENUCHTEN
  RESIDUAL_SATURATION 0.1
  LAMBDA 0.5
  ALPHA 0.0001
END

SATURATION_FUNCTION  sf2
  SATURATION_FUNCTION_TYPE VAN_GENUCHTEN
  RESIDUAL_SATURATION 0.05
  LAMBDA 0.6
  ALPHA 0.0002
END

REGION all
  COORDINATES
    0.0 0.0 0.0 
    1.0 1.0 10.0 
  /
END

REGION top_layer
  COORDINATES
    0.0 0.0 5.0 
    1.0 1.0 10.0 
  /
END

REGION bottom_layer
  COORDINATES
    0.0 0.0 0.0 
    1.0 1.0 5.0 
  /
END

REGION top
  FACE TOP
  COORDINATES
    0.0 0.0 10.0 
    1.0 1.0 10.0 
  /
END

REGION middle
  COORDINATE 0.5 0.5 5.0 
END

REGION bottom
  FACE BOTTOM
  COORDINATES
    0.0 0.0 0.0 
    1.0 1.0 0.0 
  /
END

OBSERVATION
  REGION middle
END

FLOW_CONDITION initial
  DATUM 0.0 0.0 1.0
  TYPE
    PRESSURE hydrostatic
  /
    PRESSURE 101325.0
END

FLOW_CONDITION recharge
  TYPE
    FLUX neumann
  /
    FLUX LIST
      TIME_UNITS y
      DATA_UNITS cm/y
        0.0  100.0
        0.2  0.0
    /
END

INITIAL_CONDITION initial
  FLOW_CONDITION initial
  REGION all
END

BOUNDARY_CONDITION outlet
  FLOW_CONDITION initial
  REGION bottom
END

BOUNDARY_CONDITION inlet
  FLOW_CONDITION recharge
  REGION top
END

STRATA
  REGION top_layer
  MATERIAL soil1
END

STRATA
  REGION bottom_layer
  MATERIAL soil2
END

END_SUBSURFACE

